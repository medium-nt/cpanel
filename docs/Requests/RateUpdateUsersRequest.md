# RateUpdateUsersRequest

## Назначение класса валидации

Класс `RateUpdateUsersRequest` предназначен для валидации запросов на обновление
ставок оплаты для пользователей. Этот класс используется для настройки системы
расценок за выполненные работы с учетом различных типов производственных
операций.

## Правила авторизации (метод authorize)

```php
public function authorize(): bool
{
    return true;
}
```

- Все авторизованные пользователи имеют право выполнять данный запрос
- Дополнительные проверки авторизации не требуются

## Правила валидации (метод rules)

```php
public function rules(): array
{
    return [
        'rate' => 'array',
        'rate.*' => 'nullable|numeric|min:1|max:1000',
        'not_cutter_rate' => 'array',
        'not_cutter_rate.*' => 'nullable|numeric|min:1|max:1000',
        'cutter_rate' => 'array',
        'cutter_rate.*' => 'nullable|numeric|min:1|max:1000',
    ];
}
```

### Поля валидации:

- **`rate`** - Массив ставок с закроем
    - `array` - Должно быть массивом
    - `rate.*` - Каждый элемент:
        - `nullable` - Может быть пустым (null)
        - `numeric` - Должно быть числом
        - `min:1` - Минимальное значение - 1
        - `max:1000` - Максимальное значение - 1000

- **`not_cutter_rate`** - Массив ставок без кроя
    - `array` - Должно быть массивом
    - `not_cutter_rate.*` - Каждый элемент:
        - `nullable` - Может быть пустым (null)
        - `numeric` - Должно быть числом
        - `min:1` - Минимальное значение - 1
        - `max:1000` - Максимальное значение - 1000

- **`cutter_rate`** - Массив ставок закройщика
    - `array` - Должно быть массивом
    - `cutter_rate.*` - Каждый элемент:
        - `nullable` - Может быть пустым (null)
        - `numeric` - Должно быть числом
        - `min:1` - Минимальное значение - 1
        - `max:1000` - Максимальное значение - 1000

## Кастомные сообщения об ошибках (метод messages)

```php
public function messages(): array
{
    return [
        'rate.*.numeric' => 'Поле должно быть числом',
        'rate.*.min' => 'Оплата с закроем не должна быть меньше 1',
        'rate.*.max' => 'Оплата с закроем не должна быть больше 1000',

        'not_cutter_rate.*.numeric' => 'Поле должно быть числом',
        'not_cutter_rate.*.min' => 'Оплата без кроя не должна быть меньше 1',
        'not_cutter_rate.*.max' => 'Оплата без кроя не должна быть больше 1000',

        'cutter_rate.*.numeric' => 'Поле должно быть числом',
        'cutter_rate.*.min' => 'Оплата закройщику не должна быть меньше 1',
        'cutter_rate.*.max' => 'Оплата закройщику не должна быть больше 1000',
    ];
}
```

## Кастомные атрибуты (метод attributes)

В данном классе метод `attributes` не определен.

## Особенности валидации

1. **Типы ставок** - Класс поддерживает три типа ставок оплаты:
    - `rate` - ставка с закроем (для продукции требующей крой)
    - `not_cutter_rate` - ставка без кроя (для продукции не требующей крой)
    - `cutter_rate` - ставка закройщика (специальная ставка для работы
      закройщика)

2. **Ограничения значений** - Все числовые значения ограничены диапазоном
   1-1000:
    - Минимальное значение - 1 (не допускаются нулевые или отрицательные ставки)
    - Максимальное значение - 1000

3. **Массивная структура** - Все поля являются массивами, что позволяет
   настраивать множественные ставки для различных операций

4. **Nullable значения** - Все поля могут содержать null значения, что позволяет
   создавать неполные схемы оплаты

5. **Простая валидация** - В отличие от MotivationUpdateUsersRequest, здесь
   отсутствует сложная валидация последовательности

6. **Единицы измерения** - Предполагается, что ставки указаны в денежных
   единицах (рубли, доллары и т.д.)

## Используемые в контроллерах

Данный Form Request используется в контроллере управления пользователями для
обновления ставок оплаты:

```php
// Пример использования в контроллере
public function updateRates(RateUpdateUsersRequest $request)
{
    $validated = $request->validated();

    // Обновление ставок оплаты для пользователей
    foreach ($validated['rate'] as $userId => $rate) {
        if ($rate !== null) {
            $user = User::find($userId);
            if ($user) {
                $user->rate = $rate;
                $user->save();
            }
        }
    }

    // Аналогично для other rate types
}
```

Пример валидных данных:

```json
{
    "rate": {
        "1": "150",
        "2": "200",
        "3": null
    },
    "not_cutter_rate": {
        "1": "100",
        "2": "120",
        "3": "80"
    },
    "cutter_rate": {
        "1": "50",
        "2": "60",
        "3": null
    }
}
```

## Сравнение с MotivationUpdateUsersRequest

| Характеристика               | MotivationUpdateUsersRequest                    | RateUpdateUsersRequest             |
|------------------------------|-------------------------------------------------|------------------------------------|
| Назначение                   | Настройка системы мотивации (бонусы)            | Настройка базовых ставок оплаты    |
| Валидация последовательности | Есть (проверка возрастания)                     | Отсутствует                        |
| Минимальное значение         | 0 (для бонусов)                                 | 1 (для ставок)                     |
| Тип полей                    | from, to, bonus, not_cutter_bonus, cutter_bonus | rate, not_cutter_rate, cutter_rate |
| Сложность                    | Высокая (диапазонная система)                   | Низкая (простые ставки)            |

## Контекст использования

Класс является ключевым для управления системой оплаты труда сотрудников:

1. Позволяет дифференцировать оплату для различных типов работ
2. Обеспечивает гибкую настройку ставок для разных сотрудников
3. Поддерживает раздельную оплату для работы с кроем и без него
4. Предоставляет специальную ставку для закройщиков как отдельной категории
   специалистов

Это более простая система по сравнению с мотивационными бонусами, так как
оперирует фиксированными ставками, а не диапазонами значений.
