# WriteOffRemnantsController

**Путь:** `app/Http/Controllers/WriteOffRemnantsController.php`

## Общее назначение

Контроллер для управления списанием остатков материалов со склада. Обеспечивает
создание и отображение операций списания.

## Зависимости и сервисы

- `App\Http\Requests\StoreRemnantsRequest` - класс валидации запроса на списание
- `App\Models\Material` - модель материала
- `App\Models\Order` - модель заказа
- `App\Models\Supplier` - модель поставщика
- `App\Services\WriteOffRemnantService` - сервис обработки списания остатков

## Список методов

### index()

- **Описание:** Отображение списка всех операций списания остатков
- **URL:** `/write_off_remnants`
- **Метод:** GET
- **Возвращает:** `Illuminate\View\View`
- **Представление:** `write_off_remnants.index`
- **Данные:**
    - `title` (string) - заголовок страницы
    - `orders` (LengthAwarePaginator) - коллекция заказов с пагинацией (10 на
      страницу)
- **Фильтрация:**
    - `where('type_movement', 8)` - только заказы типа списание остатков
    - `latest()` - сортировка по убыванию даты создания

### create()

- **Описание:** Форма создания новой операции списания остатков
- **URL:** `/write_off_remnants/create`
- **Метод:** GET
- **Возвращает:** `Illuminate\View\View`
- **Представление:** `write_off_remnants.create`
- **Данные:**
    - `title` (string) - заголовок страницы
    - `materials` (Collection) - список всех материалов
    - `suppliers` (Collection) - список всех поставщиков

### store(StoreRemnantsRequest $request)

- **Описание:** Сохранение новой операции списания остатков
- **URL:** `/write_off_remnants`
- **Метод:** POST
- **Параметры:** Валидируются через `StoreRemnantsRequest`
- **Возвращает:** Результат выполнения `WriteOffRemnantService::store($request)`
- **Делегирование:** Вся бизнес-логика перенесена в сервисный слой

## Закомментированные методы

Следующие методы закомментированы и не используются:

- `edit(Order $order)` - форма редактирования
- `update(UpdateMovementMaterialFromSupplierRequest $request, Order $order)` -
  обновление
- `destroy(MovementMaterial $movementMaterial)` - удаление

## Работа с моделями данных

- **Order:** Основная модель для хранения информации о списаниях
- **Material:** Справочник материалов
- **Supplier:** Справочник поставщиков

## Типы движения

- `type_movement = 8` - списание остатков материалов

## Валидация

Используется отдельный класс валидации `StoreRemnantsRequest` для проверки
входных данных при создании списания.

## Права доступа

- Контроллер не использует Gate или middleware для проверки прав доступа
- Предполагается использование глобальных middleware для аутентификации

## Особенности реализации

- Вся бизнес-логика вынесена в сервис `WriteOffRemnantService`
- Контроллер выполняет только роль посредника между HTTP-слоем и сервисным слоем
- Методы редактирования и удаления закомментированы, что говорит об
  окончательности операций списания после создания
- Минимальный функционал - только создание и просмотр операций списания
