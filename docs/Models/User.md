# Модель User

**Путь:** `app/Models/User.php`

**Назначение:** Модель пользователя системы, наследуется от Authenticatable для
поддержки аутентификации в Laravel

**Таблица в БД:** `users`

## Атрибуты

### Fillable (массово назначаемые)

- `name` - Имя пользователя
- `email` - Email адрес
- `phone` - Телефон
- `password` - Хэш пароля
- `role_id` - ID роли пользователя
- `is_cutter` - Флаг, может ли пользователь выполнять резку (boolean)
- `salary_rate` - Ставка заработной платы
- `avatar` - Путь к аватару
- `tg_id` - ID в Telegram
- `orders_priority` - Приоритет заказов
- `shift_is_open` - Флаг открытой смены
- `start_work_shift` - Время начала смены
- `duration_work_shift` - Продолжительность смены
- `max_late_minutes` - Максимальное время опоздания в минутах
- `is_show_finance` - Флаг отображения финансовой информации

### Hidden (скрытые при сериализации)

- `password` - Пароль
- `remember_token` - Токен запоминания

### Casts (преобразование типов)

- `email_verified_at` - `datetime` - Дата верификации email
- `password` - `hashed` - Автоматическое хэширование пароля
- `salary_rate` - `float` - Преобразование ставки в вещественное число

## Связи (Relationships)

### BelongsTo (принадлежит к)

- `role()` - Связь с моделью `Role` (многие к одному)

### HasMany (имеет много)

- `marketplaceOrderItems()` - Элементы заказов, где пользователь является швеей
- `marketplaceOrderItemsByCutter()` - Элементы заказов, где пользователь
  является резчиком

### BelongsToMany (многие ко многим)

- `materials()` - Материалы, закрепленные за пользователем

## Методы-аксессоры и мутаторы

### Акцессоры (getters)

- `getUpdatedDateAttribute()` - Возвращает дату обновления в формате d/m/Y H:i
- `getCreatedDateAttribute()` - Возвращает дату создания в формате d/m/Y H:i
- `getEndWorkShiftAttribute()` - Вычисляет время окончания смены на основе
  начала и продолжительности
- `getShortNameAttribute()` - Возвращает сокращенное имя (Фамилия И.О.)

## Методы проверки ролей

- `isAdmin()` - Проверяет, является ли пользователь администратором
- `isCutter()` - Проверяет, является ли пользователь резчиком
- `isSeamstress()` - Проверяет, является ли пользователь швеей
- `canSeamstressCut()` - Проверяет, может ли швея выполнять резку
- `isStorekeeper()` - Проверяет, является ли пользователь кладовщиком
- `isOtk()` - Проверяет, является ли пользователь сотрудником ОТК

## Специфичные методы

- `adminlte_profile_url()` - Возвращает URL профиля для AdminLTE
- `adminlte_desc()` - Возвращает описание роли пользователя для AdminLTE с
  использованием сервиса `UserService`

## Особенности использования

1. **SoftDeletes:** Модель использует мягкое удаление (trait SoftDeletes)
2. **Аутентификация:** Наследует от Authenticatable для поддержки системы
   аутентификации Laravel
3. **Управление сменами:** Поддерживает отслеживание рабочих смен пользователей
4. **Интеграция с AdminLTE:** Имеет специальные методы для интеграции с шаблоном
   AdminLTE
5. **Ролевая модель:** Использует гибкую систему ролей через связь с моделью
   Role
6. **Telegram интеграция:** Поддерживает привязку к Telegram через tg_id

## Примеры использования

```php
// Получение пользователя с ролью
$user = User::with('role')->find($id);

// Проверка прав
if ($user->isAdmin()) {
    // логика для администратора
}

// Получение активных заказов швеи
$activeOrders = $user->marketplaceOrderItems()
    ->where('status', '!=', StatusMovement::COMPLETED)
    ->get();

// Проверка возможности резки
if ($user->canSeamstressCut()) {
    // пользователь может выполнять резку
}
```
